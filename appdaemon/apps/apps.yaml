utils:
  module: utils
  class: utils

### People Presence Automations
presence:
  module: presence
  class: Presence
  dependencies: utils
  arrival_on:
    - light.floor_lamp
    - light.kitchen
    - switch.template_harmony_fetch
  arrival_off:
    - light.hallway_2
  away_on:
    - light.hallway_2
  away_off:
    - group.all_lights
    - remote.living_room
    - switch.template_samsung_tv
  radio:
    device: media_player.google_home_office
    url: 'https://abc.ihrcast.arn.com.au/iHRabc01?'
  # people_notifications:
  #   - device_tracker.mums_lg_g4
  residents:
    - device_tracker.nicks_note8
    - device_tracker.ashs_s10

### Time Based Automations ###
sunset:
  module: sun
  class: Sunset
  dependencies: utils
  athome_on:
    - light.floor_lamp
    - light.kitchen
  away_on: 
    - light.hallway_2
xmas_lights:
  module: sun
  class: Fairylights
  dependencies: utils
  lights:
    - switch.tp_link_1
  sunrise_offset: -60
  sunset_offset: -15

### Google Home Volume Control ###    
gh_main:
  module: google_home
  class: Quiet_Mode
  dependencies: utils
  device: media_player.google_home_main
  night_mode:
    hour: 23
    min: 5
    vol: 0.3
  day_mode: 
    hour: 5
    min: 59
    vol: 0.55
gh_office:
  module: google_home
  class: Quiet_Mode
  dependencies: utils
  device: media_player.google_home_office
  night_mode:
    hour: 23
    min: 5
    vol: 0.2
  day_mode: 
    hour: 6
    min: 55
    vol: 0.4
gh_bedroom:
  module: google_home
  class: Quiet_Mode
  dependencies: utils
  device: media_player.google_home_bedroom
  night_mode:
    hour: 21
    min: 55
    vol: 0.2
  day_mode: 
    hour: 6
    min: 55
    vol: 0.4

### Xiaomi Buttons ###
bedroom_buttons:
  module: xiaomi
  class: Button
  dependencies: utils
  buttons:
    - binary_sensor.xiaomi_switch_1
    - binary_sensor.xiaomi_switch_2
  actions:
    - click_type: single
      type: standard
      target_dev: light.bedroom
      service: toggle
    - click_type: double
      type: standard
      target_dev: switch.template_soniq_tv
      service: toggle
    - click_type: long_click_press
      type: standard
      target_dev: switch.master_switch
      service: turn_off
guest_bedroom__button:
  module: xiaomi
  class: Button
  dependencies: utils
  buttons:
    - binary_sensor.xiaomi_switch_6
  actions:
    - click_type: single
      type: dimmer
      dim_step: 4
      target_dev: light.guest_bedroom
    - click_type: long_click_press
      type: standard
      target_dev: light.guest_bedroom
      service: toggle
outside_button:
  module: xiaomi
  class: Button
  dependencies: utils
  buttons:
    - binary_sensor.xiaomi_switch_4
  actions:
    - click_type: single
      type: standard
      target_dev: light.outdoor_led
      service: toggle
study_button:
  module: xiaomi
  class: Button
  dependencies: utils
  buttons:
    - binary_sensor.xiaomi_switch_5
  actions:
    - click_type: single
      type: dimmer
      dim_step: 3
      target_dev: light.study
    - click_type: long_click_press
      type: standard
      target_dev: light.study
      service: toggle
doorbell:
  module: xiaomi
  class: Doorbell
  dependencies: utils
  buttons:
    - binary_sensor.xiaomi_switch_3
  click_type: single
  gw_mac: !secret xiaomi_mac
  ringtone_id: 10001
  vol_slider: input_number.doorbell_volume 
  courtesy_light: 
    entity_id: light.front_porch
    timer: 180
  # flash:
  #   - light.study
  #   - light.spare_room
  #   - light.kitchen
  #   - light.dining
  #   - light.living_room

### Sensor Lights ###
pantry_motion_light:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_presence: anyone
  light: light.pantry_light
  sensor: binary_sensor.xiaomi_motion_1
  duration: 300
  toggle: input_boolean.pantry_sensor_light
hallway_motion_light:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  constrain_presence: anyone
  light: light.hallway_2
  sensor: binary_sensor.konnected_zone_3
  duration: 120
  toggle: input_boolean.main_hallway_sensor_light
back_hallway_motion_light:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  constrain_presence: anyone
  light: light.back_hallway
  sensor: binary_sensor.konnected_zone_4
  duration: 120
  toggle: input_boolean.back_hallway_sensor_light
backyard_door_light:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  light: light.outdoor_led
  sensor: binary_sensor.xiaomi_door_2
  duration: 180
  toggle: input_boolean.sliding_door_light
front_door_light:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  light: light.front_porch
  sensor: binary_sensor.xiaomi_door_1
  duration: 180
  toggle: input_boolean.front_door_light
garage_open_light_1:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  light: light.front_porch
  sensor: cover.garage_main
  duration: 180
  toggle: input_boolean.main_garage_door_light
garage_open_light_2:
  module: sensor
  class: sensor_light
  dependencies: utils
  constrain_start_time: sunset
  constrain_end_time: sunrise
  light: light.outdoor_led
  sensor: cover.garage_rear
  duration: 180
  toggle: input_boolean.rear_garage_door_light

  
### Sensors
alarm:
  module: sensor
  class: Notifications
  dependencies: utils
  toggle: input_boolean.motion_notifications
  sensors:
    - binary_sensor.konnected_zone_1
    - binary_sensor.konnected_zone_2
    - binary_sensor.konnected_zone_3
    - binary_sensor.konnected_zone_4
    - binary_sensor.konnected_zone_5
    - binary_sensor.xiaomi_motion_1
    - binary_sensor.xiaomi_door_1
    - binary_sensor.xiaomi_door_2
    - cover.garage_main
    - cover.garage_rear
water_sensors:
  module: sensor
  class: Notifications
  dependencies: utils
  notify_when_home: True
  sensors:
    - binary_sensor.xiaomi_water_1
    - binary_sensor.xiaomi_water_2
    - binary_sensor.xiaomi_water_3
garage:
  module: sensor
  class: Notifications
  dependencies: utils
  notify_when_home: True
  duration: 1200
  sensors:
    - cover.garage_main
    - cover.garage_rear

### Timers ###
timer_main_ac:
  module: timer
  class: Timer
  dependencies: utils
  device: climate.living_room
  input: input_number.timer_main_ac
  units: hours
timer_bedroom_ac:
  module: timer
  class: Timer
  dependencies: utils
  device: climate.bedroom
  input: input_number.timer_bedroom_ac
  units: hours
timer_bedroom_tv:
  module: timer
  class: Timer
  dependencies: utils
  device: switch.template_soniq_tv
  input: input_number.timer_bedroom_tv
  units: minutes
timer_main_tv:
  module: timer
  class: Timer
  dependencies: utils
  device: remote.living_room
  input: input_number.timer_main_tv
  units: minutes

